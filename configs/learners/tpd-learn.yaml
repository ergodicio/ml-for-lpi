density:
  basis: linear
  gradient scale length: 400.0um
  max: 0.28
  min: 0.18
  noise:
    max: 1.0e-09
    min: 1.0e-10
    type: uniform
    
drivers:
  E0:
    delta_omega_max: 0.005
    envelope:
      tc: 200.25ps
      tr: 0.1ps
      tw: 4000ps
      xc: 50um
      xr: 0.2um
      xw: 1000um
      yc: 50um
      yr: 0.2um
      yw: 1000um
    num_colors: 32
    shape: generative
    params:
      amplitudes: 
        init: uniform # uniform, random
        learned: true
        activation: log
        bounded: false
      phases:
        init: random # random, seed-###
        learned: true
        seed: 42
      nn:
          decoder_width: 32
          output_width: 32
          input_width: 8
          decoder_depth: 3
          key: 424
          activation: tanh

grid:
  boundary_abs_coeff: 1
  boundary_width: 3.0um
  dt: 5.04fs
  dx: 72nm
  low_pass_filter: 0.66
  tmax: 25ps
  tmin: 0.0ns
  ymax: 6um
  ymin: -6um

intensity_schedule:
  min_initial: 0.5      # Starting lower bound for intensity factors
  min_target: 1.8       # Target lower bound (reached when model is mature)
  max_initial: 0.7      # Starting upper bound for intensity factors
  max_target: 3.5       # Target upper bound (reached when model is mature)
  loss_target_low: -20.0  # Loss below this indicates factors may be too low
  loss_target_high:  -12.0 # Loss above this indicates numerical instability
  nan_threshold: 0.2    # NaN fraction threshold for stability checks
  growth_rate: 1.08     # Multiplicative factor for expanding range (8% per epoch)
  shrink_rate: 0.95     # Multiplicative factor for reducing range when unstable

training data:
  num_temperatures: 4
  num_gradient_scale_lengths: 4

validation:
  # New format: specify exact (Te, GSL) pairs directly
  pairs:
    - [2000.0, 200.0]  # Low temp, short gradient
    - [4000.0, 600.0]  # High temp, long gradient
  pairs_per_epoch: 2  # How many pairs to validate each epoch (samples without replacement)
  intensity_scan:
    num_samples: 8
    max_total_samples: 16

  # Old format (still supported if 'pairs' not specified):
  # temperatures: [2000.0, 4000.0]
  # gradient_scale_lengths: [200.0, 600.0]
  # temperatures_per_epoch: 2
  # gradient_scale_lengths_per_epoch: 2

parsl:
  provider: gpu
  nodes: 4
  walltime: 12:00:00

mlflow:
  experiment: learn-tpd-25ps
  run: Te-Ln-avg-generative

save:
  fields:
    t:
      dt: 0.1ps
      tmax: 25ps
      tmin: 0ps
    x:
      dx: 80nm
    y:
      dy: 80nm
solver: envelope-2d
terms:
  epw:
    hyperviscosity:
      order: 6
      coeff: 0.0
    boundary:
      x: absorbing
      y: periodic
    damping:
      collisions: 0.1
      landau: true
    density_gradient: true
    linear: true
    source: 
      noise: true
      tpd: true
      srs: false
  zero_mask: true
units:
  atomic number: 40
  envelope density: 0.25
  ionization state: 6
  laser intensity: 7.0e14 W/cm^2
  laser_wavelength: 351nm
  reference electron temperature: 3200 eV
  reference ion temperature: 1000eV
opt:
  learning_rate: 0.003
  batch_size: 1
  decay_steps: 100000
  method: optax
  metric_time_in_ps: 98.5
  checkpoints_coeff: 2.0 # number of checkpoints = checkpoints_coeff * (sqrt(2 * (max_steps + 2048) + 0.25) - 1.5)
  # XLA cache cleanup interval (iterations for scipy, epochs for optax)
  # Helps prevent memory buildup during long optimization runs
  cache_cleanup_interval: 1
